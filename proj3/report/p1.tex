\section{Link budget model}
A \emph{link budget model} is a way of estimating the power $P_R$ of a received signal by taking into account the possible sources of gain and loss over the trasmission.
Since the aforementioned gains and losses are typically expressed in the form of ratios, the calculation of a link budget becomes trivial if employing decibels.

In the case of a satellite link, the following factors are taken into account in the budget:

\begin{equation}
	P_{R, dB} = 20\log_{10}\left(\frac{4 \pi d}{\lambda}\right) + {ERP}_{dB} + G_{R, dB} - L_{0, dB}
\end{equation}

\begin{description}
	\item[$(\frac{4 \pi d}{\lambda})^2$] Free-space loss
	\item[$ERP$] Effective radiated power
	\item[$G_R$] Gain of receiver antenna
	\item[$L_0$] Other losses (e.g. atmospheric absorption)
\end{description}

The following subsections will attempt to explain some of these factors.

\subsection{Free-space loss}
The free-space loss is the signal strength loss occurring in a line-of-sight path through free space (usually air), without accounting for reflection or diffraction. The equation for the free-space loss is given by:

\begin{equation}
	{FSPL} = \left(\frac{4 \pi d}{\lambda}\right)^2
\end{equation}

where $d$ represents the distance between transmitter and receiver, and $\lambda$ is wavelength of the signal with frequency $f$.
In decibels, it can also be expressed as:

\begin{equation}
	{FSPL}_{dB} = 20\log_{10}(d) + 20\log_{10}(f) - 147.55
\end{equation}

The equation results in a loss term, meaning that its value will always be confined between 0 and 1, or always negative when expressed in decibels.

It is clearly noticeable how the equation resembles that of the sphere surface area; with higher values of distance or signal frequency, the loss increases.

% TODO picture?


\subsection{Effective radiated power}
The effective radiated power is the equivalent power transmitted equally in all directions, from a theoretical spherically radiating source, also known as isotropic radiator.
It is obtained by:

\begin{equation}
	{ERP}_{dB} = 10\log_{10}(P_T) + G_{T, dB}
\end{equation}

where $P_T$ is the output power of the transmitter and $G_T$ is the gain of its antenna in respect to the isotropic radiator model.


\subsection{Link budget margin}
The link margin is the additional amount of attenuation that a transceiving system can tolerate while still functioning.
It is recommended to include a margin of a few decibels in the link budget, in order to account for unpredicted losses.

In the case of satellite communication, the margin might comprise of rain fade or atmospheric absorption.
Other common sources of signal degradation which are included in the link margin are components tolerances and wear.


\section{$SNR$ and $P_E$}

\subsection{Calculation of signal-to-noise ratio}
The $SNR$ of the satellite transmission can be calculated as:

\begin{equation}
	{SNR}_{dB} = P_{R, dB} - P_{int, dB}
\end{equation}

where $P_R$ is the previously introduced power of the received signal, and $P_{int}$ is the power of the receiver output noise.
The latter is provided by:

\begin{equation}
	P_{int} = k T_R B
\end{equation}

where $T_R$ is the noise temperature of the receiver, $B$ is the bandwidth of the transmission, and $k$ is the Boltzmann constant.


\subsection{Calculation of bit error probability}
The bit error probability of a biphase-shift
keying (\emph{BPSK}) transmission is calculated as:

\begin{equation}
	P_E = Q\left(\sqrt{\frac{2 E_b}{N_0}}\right)
\end{equation}

It is possible to extrapolate the required energy-per-bit-to-noise spectral density ratio $E_b/N_0$ from the $SNR$ figure.
Multiplying numerator and denominator by the bit duration $T_b$ gives:

\begin{equation}
	SNR = \frac{P_R T_b}{k T_R T_b} \rightarrow \frac{E_b}{N_0 B T_b}
\end{equation}

In case of a binary \emph{BPSK} (biphase-shift
keying) transmission, the bandwidth $B$ is $2/T_b$, so the factor $B T_b$ is 2.


\subsection{Impact of parameters $d$, $\lambda$, and $B$}
This section will investigate the different roles of the receiver and transmitter distance, the wavelength of the signal, and its bandwidth, in the calculation of the signal-to-noise ratio and the bit error probability.
The following graphs will show the surfaces generated by the combination of two of the aforementioned parameters:

\begin{itemize}
	\item $d$ (distance) is given values between 1 km and 10000 km
	\item $\lambda$ (wavelength) is given values for frequencies between 300 MHz and 300 GHz
	\item $B$ (bandwidth) is given values between 10 kHz and 10 MHz
\end{itemize}

\fig{9cm}{d_lambda.png}{${SNR}_{dB}$ and $P_E$ for different values of distance and wavelength}

As previously introduced, increasing distance and frequency (thus decreasing wavelength) negatively affects the $SNR$ and $P_E$ values.
The performance decay is quite drastic due to the power-of-two factor in the free-space loss.

\fig{9cm}{lambda_b.png}{${SNR}_{dB}$ and $P_E$ for different values of wavelength and bandwidth}

\fig{9cm}{d_b.png}{${SNR}_{dB}$ and $P_E$ for different values of distance and bandwidth}

In the four plots above, it can be noticed how a wider bandwidth does also negatively affect the performance of the system.
However, it has a minor overall impact compared to distance and wavelength.

The MATLAB code used to generate the figures closely resembles the one used to calculate $SNR$ and $P_E$, and can be found in the appendix.


\subsection{Bit error probability at different transmission powers}
In this section, the impact of the transmitter power will be analyzed, drawing from a sequence of given values.
All the other parameters in the link budget model will use the values in the literature examples $A.8$ and $A.9$.

For transmitted power $P_T$ values of 50 W, 5 W, and 500 mW, the bit error probability $P_E$ results in:

\begin{lstlisting}[language=Octave]
    p_e =
        1.4062e-05   9.2684e-02   3.3768e-01
\end{lstlisting}

With a power of 50 W, the bit error probability is barely adequate, while it reaches 9.3\% and 34\% at 5 W and 500  mW respectively.
These last two figures would cause the transmission to be erratic beyond what is commonly considered usable.

Here follows a graph of the bit error probability across a range of transmitted power values:

\fig{7cm}{pt.png}{$P_E$ for different values of transmitted power}

As it can be seen here, it is necessary to transmit about 60 W of power in order to obtain a reliable link (bit error probability of less than 0.0001\%)


\section{Alternative modulation methods}
This section will explore and discuss alternative modulation techniques, and determine their properties in terms of signal-to-noise ratio and bit error probability.


\subsection{Method 1: Amplitude-shift keying}
Amplitude-shift keying (ASK) is a modulation technique which consists in gating a sinusoidal signal on or off.
The resulting symbol waveforms are:

\begin{itemize}
	\item $0$ for a 0 bits
	\item $A\cos(2 \pi f_c t) \Pi(\frac{t-T/2}{T})$ for 1 bits
\end{itemize}

where $\Pi(x)$ is the rectangular function, and $f_c$ is the carrier frequency.

It is possible to derive the bit error probability for ASK using the generic equations:

\begin{equation}
	P_E = Q\left(\sqrt{\left(1 - R_{12}\right) \frac{E_b}{N_0}}\right)
\end{equation}

\begin{equation}
	R_{12} = \frac{\sqrt{E_1 E_2}}{E_b}\rho_{12}
\end{equation}

\begin{equation}
	\rho_{12} = \frac{1}{\sqrt{E_1 E_2}} \int_{-\infty}^{\infty} s_1(t) s_2(t) dt
\end{equation}

where $\rho_{12}$ is a normalized correlation coefficient which expresses how similar the two symbol waveforms are, and $R_{12}$ is another coefficient related to the former.

In the case of ASK modulation, it holds that $R_{12} = \rho_{12} = 0$, meaning that the bit error probability equation becomes:

\begin{equation}
	P_E = Q\left(\sqrt{\frac{E_b}{N_0}}\right)
\end{equation}

Whilst the formula is similar to the one previously introduced for the calculation of $P_E$ in a BPSK transmission, it lacks a $\sqrt{2}$ term.
Therefore, the signal-to-noise radio of a ASK transmission has to be 3 dB higher in order to maintain the same performances.

For the examined satellite link, the bit error probabilities at 50 W, 5 W, and 500 mW would result in:

\begin{lstlisting}[language=Octave]
    p_e =
        0.0015135   0.1742226   0.3834248
\end{lstlisting}

The values above show a considerable loss of performances when adopting ASK over BPSK.


\subsection{Method 2: Frequency-shift keying}
This modulation technique involves the transmission of sinusoidal waves with different frequency for each symbol.
The resulting waveforms are:

\begin{itemize}
	\item $A\cos(\omega_c t)$ for a 0 bits
	\item $A\cos((\omega_c + \Delta\omega) t)$ for 1 bits
\end{itemize}

For simplicity sake, it holds that:

\begin{itemize}
	\item $ \omega_c = \frac{2 \pi n}{T} $
	\item $ \Delta\omega = \frac{2 \pi m}{T} $
\end{itemize}

where $n$ and $m$ are integer coefficients, so that the number of cycles within each symbol length $T$ is integer too.
These assumptions result in $R_{12} = 0$, and therefore the bit probability error equations is the same as for ASK:

\begin{equation}
	P_E = Q\left(\sqrt{\frac{E_b}{N_0}}\right)
\end{equation}

However, when deriving the $E_b / N_0$ ratio from the signal-to-noise ratio, the required bandwidth is given by $2.5 / T$, so the factor $B T_b$ becomes 2.5, or around 4 dB.

In the case of a FSK satellite link, the bit error probabilities at 50 W, 5 W, and 500 mW would result in:

\begin{lstlisting}[language=Octave]
    p_e =
        4.5830e-04   1.4726e-01   3.7014e-01
\end{lstlisting}

Although this can be seen as an improvement over the ASK system, the calculated values, corresponding to probabilities of 0.0005\%, 15\%, and 37\%, are still not adequate for a transmission link.

\lstset{
  caption=\lstname
}

\section{Source code}
Here follows a thoroughly commented version of the MATLAB script used for the above calculations and observations.

\subsection{$SNR$ and $P_E$}
The script below computes the signal-to-noise ratio and bit error probability for the free-space transmission characterized by its input parameters.

\begin{lstinputlisting}[language=Octave]{../scripts/satellite.m}
\end{lstinputlisting}


\subsection{$d$, $\lambda$, and $B$}
The scripts below are used to investigate the relationships between the parameters $d$, $\lambda$, and $B$, and the signal-to-noise ratio and bit error probability.

\begin{lstinputlisting}[language=Octave]{../scripts/satellite_plot_d_lambda.m}
\end{lstinputlisting}

\begin{lstinputlisting}[language=Octave]{../scripts/satellite_plot_lambda_b.m}
\end{lstinputlisting}

\begin{lstinputlisting}[language=Octave]{../scripts/satellite_plot_d_b.m}
\end{lstinputlisting}


\subsection{$P_T$}
The scripts below are used to investigate the impact of the transmitter power on the bit error probability.

\begin{lstinputlisting}[language=Octave]{../scripts/satellite_pt.m}
\end{lstinputlisting}


\subsection{Alternative modulation methods}
The scripts below are used to investigate the properties and performances of different modulation schemes.

\begin{lstinputlisting}[language=Octave]{../scripts/satellite_ask.m}
\end{lstinputlisting}

\begin{lstinputlisting}[language=Octave]{../scripts/satellite_fsk.m}
\end{lstinputlisting}
